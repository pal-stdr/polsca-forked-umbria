UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR=$(UMBRIA_CPU_FLOW_RELATIVE_TMP_DIR)/polybench
UMBRIA_POLYBENCH_PYTHON_SCRIPT=scripts/umbria-scripts/umbria-polybench-cpu-flow.py
POLYBENCH_SRC_DIR=./example/polybench
POLYBENCH_DATASET=LARGE
POLYBENCH_EXAMPLE=2mm
POLYBENCH_KERNELS=2mm
# EXCLUDE_POLYBENCH_KERNELS=symm doitgen fdtd-2d nussinov
EXCLUDE_POLYBENCH_KERNELS=deriche
EXCLUDE_POLYBENCH_KERNELS_FOR_SCALEHLS_TRANSFORMATION=deriche correlation floyd-warshall nussinov


# With Polymer


verify-one-polybench-kernel-with-polymer-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -p --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/verify-one-polybench-kernel-with-polymer --dataset=$(POLYBENCH_DATASET) --verify-benchmark-result --error-threshold 0.00001 --dump-csv-report


verify-polybench-kernels-with-polymer-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) -p --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/verify-polybench-kernels-with-polymer --dataset=$(POLYBENCH_DATASET) --verify-benchmark-result --error-threshold 0.00001 --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



run-one-polybench-kernel-with-polymer-no-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -p --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-one-polybench-kernel-with-polymer-no-opt --dataset=$(POLYBENCH_DATASET) --run-bin-on-cpu --dump-csv-report


run-polybench-kernels-with-polymer-no-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) -p --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-polybench-kernels-with-polymer-no-opt --dataset=$(POLYBENCH_DATASET) --run-bin-on-cpu --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



run-one-polybench-kernel-with-polymer-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -p --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-one-polybench-kernel-with-polymer-opt --dataset=$(POLYBENCH_DATASET) --clang-opt-bin --run-bin-on-cpu --dump-csv-report


run-polybench-kernels-with-polymer-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) -p --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-polybench-kernels-with-polymer-opt --dataset=$(POLYBENCH_DATASET) --clang-opt-bin --run-bin-on-cpu --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



compile-one-polybench-kernel-with-polymer-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -p --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/compile-one-polybench-kernel-with-polymer --dataset=$(POLYBENCH_DATASET) --dump-test-data-cpu


compile-polybench-kernels-with-polymer-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) -p --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/compile-polybench-kernels-with-polymer --dataset=$(POLYBENCH_DATASET) --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



transform-one-polybench-kernel-with-polymer-example-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -p --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-one-polybench-kernel-with-polymer --only-kernel-transformation --excl $(EXCLUDE_POLYBENCH_KERNELS)


transform-polybench-kernels-with-polymer-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) -p --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-polybench-kernels-with-polymer --only-kernel-transformation --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)





# With Polymer + Scalehls


transform-one-polybench-kernel-with-polymer-scalehls-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -p --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-one-polybench-kernel-with-polymer-scalehls --only-kernel-transformation --enable-scalehls


transform-polybench-kernels-with-polymer-scalehls-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) -p --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-polybench-kernels-with-polymer-scalehls --only-kernel-transformation --enable-scalehls --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS_FOR_SCALEHLS_TRANSFORMATION)





# Without Polymer


verify-one-polybench-kernel-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/verify-one-polybench-kernel --dataset=$(POLYBENCH_DATASET) --verify-benchmark-result --error-threshold 0.00001


verify-polybench-kernels-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/verify-polybench-kernels --dataset=$(POLYBENCH_DATASET) --verify-benchmark-result --error-threshold 0.00001 --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



run-one-polybench-kernel-no-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-one-polybench-kernel-no-opt --dataset=$(POLYBENCH_DATASET) --run-bin-on-cpu


run-polybench-kernels-no-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-polybench-kernels-no-opt --dataset=$(POLYBENCH_DATASET) --run-bin-on-cpu --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



run-one-polybench-kernel-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-one-polybench-kernel-opt --dataset=$(POLYBENCH_DATASET) --clang-opt-bin --run-bin-on-cpu


run-polybench-kernels-opt-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/run-polybench-kernels-opt --dataset=$(POLYBENCH_DATASET) --clang-opt-bin --run-bin-on-cpu --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



compile-one-polybench-kernel-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/compile-one-polybench-kernel --dataset=$(POLYBENCH_DATASET)


compile-polybench-kernels-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/compile-polybench-kernels --dataset=$(POLYBENCH_DATASET) --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)



transform-one-polybench-kernel-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-one-polybench-kernel --dataset=$(POLYBENCH_DATASET) --only-kernel-transformation --dump-csv-report


transform-polybench-kernels-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-polybench-kernels --dataset=$(POLYBENCH_DATASET) --only-kernel-transformation --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS)





# Without Polymer, but with Scalehls


transform-one-polybench-kernel-with-scalehls-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) --source-dir $(POLYBENCH_SRC_DIR) -e $(POLYBENCH_EXAMPLE) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-one-polybench-kernel-with-scalehls --only-kernel-transformation --enable-scalehls --dump-csv-report


transform-polybench-kernels-with-scalehls-umbria-cpu-flow:
	PYTHONPATH=$(shell pwd) python3 $(UMBRIA_POLYBENCH_PYTHON_SCRIPT) -j $(th) --source-dir $(POLYBENCH_SRC_DIR) --work-dir $(UMBRIA_POLYBENCH_CPU_FLOW_RELATIVE_TMP_DIR)/transform-polybench-kernels-with-scalehls --only-kernel-transformation --enable-scalehls --dump-csv-report --excl $(EXCLUDE_POLYBENCH_KERNELS_FOR_SCALEHLS_TRANSFORMATION)